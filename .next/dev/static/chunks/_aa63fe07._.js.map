{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/tanmay/mental-health-assistant/frontend/lib/withAuth.js"],"sourcesContent":["'use client';\r\nimport { useSession } from 'next-auth/react';\r\nimport { useRouter, usePathname } from 'next/navigation';\r\nimport { useEffect, useRef } from 'react';\r\nimport DesignerLoader from '@/app/components/DesignerLoader';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\n\r\nexport default function withAuth(Component) {\r\n  return function AuthWrapper(props) {\r\n    const { status } = useSession();\r\n    const router = useRouter();\r\n    const pathname = usePathname();\r\n    const hasRedirected = useRef(false);\r\n\r\n    useEffect(() => {\r\n      const allowedPaths = ['/', '/login', '/signup'];\r\n      \r\n      if (status === 'unauthenticated' && !allowedPaths.includes(pathname) && !hasRedirected.current) {\r\n        hasRedirected.current = true;\r\n        \r\n        // Show toast immediately\r\n        toast.error('Please login to access this page, redirecting to login page', {\r\n          position: \"top-right\",\r\n          autoClose: 3000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          draggable: true,\r\n          progress: undefined,\r\n          theme: \"light\",\r\n        });\r\n\r\n        // Redirect after 2 seconds\r\n        setTimeout(() => {\r\n          router.push('/login');\r\n        }, 3000);\r\n      }\r\n    }, [status, pathname, router]);\r\n\r\n    // Always render ToastContainer\r\n    const toastContainer = (\r\n      <ToastContainer\r\n        position=\"top-right\"\r\n        autoClose={5000}\r\n        hideProgressBar={false}\r\n        newestOnTop={false}\r\n        closeOnClick\r\n        rtl={false}\r\n        pauseOnFocusLoss\r\n        draggable\r\n        pauseOnHover\r\n        theme=\"light\"\r\n      />\r\n    );\r\n\r\n    if (status === 'loading') {\r\n      return (\r\n        <div className='h-screen w-screen flex justify-center items-center'>\r\n          {toastContainer}\r\n          <DesignerLoader />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // For unauthenticated users on protected routes, show loading state while toast is displayed\r\n    const allowedPaths = ['/', '/login', '/signup'];\r\n    if (status === 'unauthenticated' && !allowedPaths.includes(pathname)) {\r\n      return (\r\n        <div className='h-screen w-screen flex justify-center items-center'>\r\n          {toastContainer}\r\n          <DesignerLoader />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // For all other cases, render the component\r\n    return (\r\n      <>\r\n        <Component {...props} />\r\n        {toastContainer}\r\n      </>\r\n    );\r\n  };\r\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AALA;;;;;;;AAOe,SAAS,SAAS,SAAS;;IACxC,UAAO,SAAS,YAAY,KAAK;;QAC/B,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,+JAAU;QAC7B,MAAM,SAAS,IAAA,kJAAS;QACxB,MAAM,WAAW,IAAA,oJAAW;QAC5B,MAAM,gBAAgB,IAAA,uKAAM,EAAC;QAE7B,IAAA,0KAAS;8CAAC;gBACR,MAAM,eAAe;oBAAC;oBAAK;oBAAU;iBAAU;gBAE/C,IAAI,WAAW,qBAAqB,CAAC,aAAa,QAAQ,CAAC,aAAa,CAAC,cAAc,OAAO,EAAE;oBAC9F,cAAc,OAAO,GAAG;oBAExB,yBAAyB;oBACzB,+JAAK,CAAC,KAAK,CAAC,+DAA+D;wBACzE,UAAU;wBACV,WAAW;wBACX,iBAAiB;wBACjB,cAAc;wBACd,cAAc;wBACd,WAAW;wBACX,UAAU;wBACV,OAAO;oBACT;oBAEA,2BAA2B;oBAC3B;0DAAW;4BACT,OAAO,IAAI,CAAC;wBACd;yDAAG;gBACL;YACF;6CAAG;YAAC;YAAQ;YAAU;SAAO;QAE7B,+BAA+B;QAC/B,MAAM,+BACJ,6LAAC,wKAAc;YACb,UAAS;YACT,WAAW;YACX,iBAAiB;YACjB,aAAa;YACb,YAAY;YACZ,KAAK;YACL,gBAAgB;YAChB,SAAS;YACT,YAAY;YACZ,OAAM;;;;;;QAIV,IAAI,WAAW,WAAW;YACxB,qBACE,6LAAC;gBAAI,WAAU;;oBACZ;kCACD,6LAAC,iJAAc;;;;;;;;;;;QAGrB;QAEA,6FAA6F;QAC7F,MAAM,eAAe;YAAC;YAAK;YAAU;SAAU;QAC/C,IAAI,WAAW,qBAAqB,CAAC,aAAa,QAAQ,CAAC,WAAW;YACpE,qBACE,6LAAC;gBAAI,WAAU;;oBACZ;kCACD,6LAAC,iJAAc;;;;;;;;;;;QAGrB;QAEA,4CAA4C;QAC5C,qBACE;;8BACE,6LAAC;oBAAW,GAAG,KAAK;;;;;;gBACnB;;;IAGP;;YAzEqB,+JAAU;YACd,kJAAS;YACP,oJAAW;;;AAwEhC"}},
    {"offset": {"line": 147, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/tanmay/mental-health-assistant/frontend/lib/api.js"],"sourcesContent":["import { getSession } from \"next-auth/react\";\r\n\r\nexport async function api(path, options = {}) {\r\n  const session = await getSession();\r\n\r\n  const res = await fetch(\r\n    `${process.env.NEXT_PUBLIC_API_URL}${path}`,\r\n    {\r\n      method: options.method || \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        ...(session?.backendToken && {\r\n          Authorization: `Bearer ${session.backendToken}`,\r\n        }),\r\n      },\r\n      body: options.body ? JSON.stringify(options.body) : undefined,\r\n    }\r\n  );\r\n\r\n  if (!res.ok) throw new Error(\"API Error\");\r\n  return res.json();\r\n}\r\n"],"names":[],"mappings":";;;;AAMO;AANP;;AAEO,eAAe,IAAI,IAAI,EAAE,UAAU,CAAC,CAAC;IAC1C,MAAM,UAAU,MAAM,IAAA,+JAAU;IAEhC,MAAM,MAAM,MAAM,MAChB,gEAAqC,MAAM,EAC3C;QACE,QAAQ,QAAQ,MAAM,IAAI;QAC1B,SAAS;YACP,gBAAgB;YAChB,GAAI,SAAS,gBAAgB;gBAC3B,eAAe,CAAC,OAAO,EAAE,QAAQ,YAAY,EAAE;YACjD,CAAC;QACH;QACA,MAAM,QAAQ,IAAI,GAAG,KAAK,SAAS,CAAC,QAAQ,IAAI,IAAI;IACtD;IAGF,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 176, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/tanmay/mental-health-assistant/frontend/app/assistant/page.js"],"sourcesContent":["'use client';\r\nimport React, { useState, useRef, useEffect } from \"react\";\r\nimport ReactMarkdown from \"react-markdown\";\r\nimport withAuth from \"@/lib/withAuth\";\r\nimport { api } from \"@/lib/api\";\r\n\r\nconst AssistantPage = () => {\r\n    const [messages, setMessages] = useState([\r\n        {\r\n            role: \"assistant\",\r\n            content:\r\n                \"Hi ðŸ‘‹ Iâ€™m your MindLytica assistant. I can help you understand your stress patterns and suggest healthy coping strategies.\",\r\n        },\r\n    ]);\r\n    const [input, setInput] = useState(\"\");\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const messagesRef = useRef(null);\r\n\r\n    // âœ… Scroll ONLY the chat box\r\n    useEffect(() => {\r\n        if (messagesRef.current) {\r\n            messagesRef.current.scrollTop =\r\n                messagesRef.current.scrollHeight;\r\n        }\r\n    }, [messages, loading]);\r\n\r\n    useEffect(() => {\r\n        const loadChat = async () => {\r\n            try {\r\n                const data = await api(\"/chat-history\");\r\n\r\n                if (data.messages && data.messages.length > 0) {\r\n                    setMessages(data.messages);\r\n                }\r\n            } catch (err) {\r\n                console.error(\"Failed to load chat\", err);\r\n            }\r\n        };\r\n\r\n        loadChat();\r\n    }, []);\r\n\r\n    const sendMessage = async () => {\r\n        if (!input.trim()) return;\r\n\r\n        setMessages((prev) => [...prev, { role: \"user\", content: input }]);\r\n        setInput(\"\");\r\n        setLoading(true);\r\n\r\n        const data = await api(\"/ai-assistant\", {\r\n            method: \"POST\",\r\n            body: {\r\n                message: input,\r\n            },\r\n        });\r\n\r\n        setMessages((prev) => [\r\n            ...prev,\r\n            { role: \"assistant\", content: data.reply },\r\n        ]);\r\n        setLoading(false);\r\n    };\r\n\r\n    return (\r\n        <>\r\n            <div className=\"min-h-screen bg-gray-50 px-4 py-8\">\r\n                <div className=\"max-w-3xl mx-auto bg-white rounded-xl shadow-sm flex flex-col h-[80vh]\">\r\n\r\n                    {/* Header */}\r\n                    <div className=\"p-4 border-b\">\r\n                        <h1 className=\"text-xl font-semibold\">MindLytica AI Assistant</h1>\r\n                        <p className=\"text-sm text-gray-500\">\r\n                            Supportive guidance, not medical advice\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Messages */}\r\n                    <div\r\n                        ref={messagesRef}\r\n                        className=\"flex-1 overflow-y-auto p-4 space-y-4\"\r\n                    >\r\n                        {messages.map((msg, i) => (\r\n                            <div\r\n                                key={i}\r\n                                className={`max-w-[80%] px-4 py-3 rounded-xl text-sm leading-relaxed ${msg.role === \"user\"\r\n                                    ? \"ml-auto bg-orange-100 text-gray-800\"\r\n                                    : \"mr-auto bg-gray-100 text-gray-700\"\r\n                                    }`}\r\n                            >\r\n                                {msg.role === \"assistant\" ? (\r\n                                    <div className=\"prose prose-sm max-w-none wrap-break-word\">\r\n                                        <ReactMarkdown>{msg.content}</ReactMarkdown>\r\n                                    </div>\r\n                                ) : (\r\n                                    msg.content\r\n                                )}\r\n                            </div>\r\n                        ))}\r\n\r\n                        {loading && (\r\n                            <p className=\"text-sm text-gray-400\">Assistant is typing...</p>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Input */}\r\n                    <div className=\"p-4 border-t flex gap-2\">\r\n                        <input\r\n                            value={input}\r\n                            onChange={(e) => setInput(e.target.value)}\r\n                            placeholder=\"Ask about stress, sleep, focus...\"\r\n                            className=\"flex-1 border rounded-xl px-4 py-2 outline-none\"\r\n                            onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\r\n                        />\r\n                        <button\r\n                            onClick={sendMessage}\r\n                            className=\"bg-[#F99262] text-white px-4 py-2 rounded-xl\"\r\n                        >\r\n                            Send\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Disclaimer */}\r\n                    <p className=\"text-xs text-gray-500 p-2 text-center\">\r\n                        This assistant is for awareness and support only, not diagnosis.\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n};\r\n\r\nexport default withAuth(AssistantPage);\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;;;AAJA;;;;;AAMA,MAAM,gBAAgB;;IAClB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;QACrC;YACI,MAAM;YACN,SACI;QACR;KACH;IACD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,MAAM,cAAc,IAAA,uKAAM,EAAC;IAE3B,6BAA6B;IAC7B,IAAA,0KAAS;mCAAC;YACN,IAAI,YAAY,OAAO,EAAE;gBACrB,YAAY,OAAO,CAAC,SAAS,GACzB,YAAY,OAAO,CAAC,YAAY;YACxC;QACJ;kCAAG;QAAC;QAAU;KAAQ;IAEtB,IAAA,0KAAS;mCAAC;YACN,MAAM;oDAAW;oBACb,IAAI;wBACA,MAAM,OAAO,MAAM,IAAA,oHAAG,EAAC;wBAEvB,IAAI,KAAK,QAAQ,IAAI,KAAK,QAAQ,CAAC,MAAM,GAAG,GAAG;4BAC3C,YAAY,KAAK,QAAQ;wBAC7B;oBACJ,EAAE,OAAO,KAAK;wBACV,QAAQ,KAAK,CAAC,uBAAuB;oBACzC;gBACJ;;YAEA;QACJ;kCAAG,EAAE;IAEL,MAAM,cAAc;QAChB,IAAI,CAAC,MAAM,IAAI,IAAI;QAEnB,YAAY,CAAC,OAAS;mBAAI;gBAAM;oBAAE,MAAM;oBAAQ,SAAS;gBAAM;aAAE;QACjE,SAAS;QACT,WAAW;QAEX,MAAM,OAAO,MAAM,IAAA,oHAAG,EAAC,iBAAiB;YACpC,QAAQ;YACR,MAAM;gBACF,SAAS;YACb;QACJ;QAEA,YAAY,CAAC,OAAS;mBACf;gBACH;oBAAE,MAAM;oBAAa,SAAS,KAAK,KAAK;gBAAC;aAC5C;QACD,WAAW;IACf;IAEA,qBACI;kBACI,cAAA,6LAAC;YAAI,WAAU;sBACX,cAAA,6LAAC;gBAAI,WAAU;;kCAGX,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAG,WAAU;0CAAwB;;;;;;0CACtC,6LAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;;kCAMzC,6LAAC;wBACG,KAAK;wBACL,WAAU;;4BAET,SAAS,GAAG,CAAC,CAAC,KAAK,kBAChB,6LAAC;oCAEG,WAAW,CAAC,yDAAyD,EAAE,IAAI,IAAI,KAAK,SAC9E,wCACA,qCACA;8CAEL,IAAI,IAAI,KAAK,4BACV,6LAAC;wCAAI,WAAU;kDACX,cAAA,6LAAC,sMAAa;sDAAE,IAAI,OAAO;;;;;;;;;;mFAG/B,IAAI,OAAO;mCAXV;;;;;4BAgBZ,yBACG,6LAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;;kCAK7C,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCACG,OAAO;gCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gCACxC,aAAY;gCACZ,WAAU;gCACV,WAAW,CAAC,IAAM,EAAE,GAAG,KAAK,WAAW;;;;;;0CAE3C,6LAAC;gCACG,SAAS;gCACT,WAAU;0CACb;;;;;;;;;;;;kCAML,6LAAC;wBAAE,WAAU;kCAAwC;;;;;;;;;;;;;;;;;;AAOzE;GA5HM;KAAA;6CA8HS,IAAA,6HAAQ,EAAC"}}]
}