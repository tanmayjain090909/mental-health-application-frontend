{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/tanmay/mental-health-assistant/frontend/lib/withAuth.js"],"sourcesContent":["'use client';\r\nimport { useSession } from 'next-auth/react';\r\nimport { useRouter, usePathname } from 'next/navigation';\r\nimport { useEffect, useRef } from 'react';\r\nimport DesignerLoader from '@/app/components/DesignerLoader';\r\nimport { ToastContainer, toast } from 'react-toastify';\r\n\r\nexport default function withAuth(Component) {\r\n  return function AuthWrapper(props) {\r\n    const { status } = useSession();\r\n    const router = useRouter();\r\n    const pathname = usePathname();\r\n    const hasRedirected = useRef(false);\r\n\r\n    useEffect(() => {\r\n      const allowedPaths = ['/', '/login', '/signup'];\r\n      \r\n      if (status === 'unauthenticated' && !allowedPaths.includes(pathname) && !hasRedirected.current) {\r\n        hasRedirected.current = true;\r\n        \r\n        // Show toast immediately\r\n        toast.error('Please login to access this page, redirecting to login page', {\r\n          position: \"top-right\",\r\n          autoClose: 3000,\r\n          hideProgressBar: false,\r\n          closeOnClick: true,\r\n          pauseOnHover: true,\r\n          draggable: true,\r\n          progress: undefined,\r\n          theme: \"light\",\r\n        });\r\n\r\n        // Redirect after 2 seconds\r\n        setTimeout(() => {\r\n          router.push('/login');\r\n        }, 3000);\r\n      }\r\n    }, [status, pathname, router]);\r\n\r\n    // Always render ToastContainer\r\n    const toastContainer = (\r\n      <ToastContainer\r\n        position=\"top-right\"\r\n        autoClose={5000}\r\n        hideProgressBar={false}\r\n        newestOnTop={false}\r\n        closeOnClick\r\n        rtl={false}\r\n        pauseOnFocusLoss\r\n        draggable\r\n        pauseOnHover\r\n        theme=\"light\"\r\n      />\r\n    );\r\n\r\n    if (status === 'loading') {\r\n      return (\r\n        <div className='h-screen w-screen flex justify-center items-center'>\r\n          {toastContainer}\r\n          <DesignerLoader />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // For unauthenticated users on protected routes, show loading state while toast is displayed\r\n    const allowedPaths = ['/', '/login', '/signup'];\r\n    if (status === 'unauthenticated' && !allowedPaths.includes(pathname)) {\r\n      return (\r\n        <div className='h-screen w-screen flex justify-center items-center'>\r\n          {toastContainer}\r\n          <DesignerLoader />\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // For all other cases, render the component\r\n    return (\r\n      <>\r\n        <Component {...props} />\r\n        {toastContainer}\r\n      </>\r\n    );\r\n  };\r\n}"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AACA;AALA;;;;;;;AAOe,SAAS,SAAS,SAAS;IACxC,OAAO,SAAS,YAAY,KAAK;QAC/B,MAAM,EAAE,MAAM,EAAE,GAAG,IAAA,4JAAU;QAC7B,MAAM,SAAS,IAAA,+IAAS;QACxB,MAAM,WAAW,IAAA,iJAAW;QAC5B,MAAM,gBAAgB,IAAA,+MAAM,EAAC;QAE7B,IAAA,kNAAS,EAAC;YACR,MAAM,eAAe;gBAAC;gBAAK;gBAAU;aAAU;YAE/C,IAAI,WAAW,qBAAqB,CAAC,aAAa,QAAQ,CAAC,aAAa,CAAC,cAAc,OAAO,EAAE;gBAC9F,cAAc,OAAO,GAAG;gBAExB,yBAAyB;gBACzB,4JAAK,CAAC,KAAK,CAAC,+DAA+D;oBACzE,UAAU;oBACV,WAAW;oBACX,iBAAiB;oBACjB,cAAc;oBACd,cAAc;oBACd,WAAW;oBACX,UAAU;oBACV,OAAO;gBACT;gBAEA,2BAA2B;gBAC3B,WAAW;oBACT,OAAO,IAAI,CAAC;gBACd,GAAG;YACL;QACF,GAAG;YAAC;YAAQ;YAAU;SAAO;QAE7B,+BAA+B;QAC/B,MAAM,+BACJ,8OAAC,qKAAc;YACb,UAAS;YACT,WAAW;YACX,iBAAiB;YACjB,aAAa;YACb,YAAY;YACZ,KAAK;YACL,gBAAgB;YAChB,SAAS;YACT,YAAY;YACZ,OAAM;;;;;;QAIV,IAAI,WAAW,WAAW;YACxB,qBACE,8OAAC;gBAAI,WAAU;;oBACZ;kCACD,8OAAC,8IAAc;;;;;;;;;;;QAGrB;QAEA,6FAA6F;QAC7F,MAAM,eAAe;YAAC;YAAK;YAAU;SAAU;QAC/C,IAAI,WAAW,qBAAqB,CAAC,aAAa,QAAQ,CAAC,WAAW;YACpE,qBACE,8OAAC;gBAAI,WAAU;;oBACZ;kCACD,8OAAC,8IAAc;;;;;;;;;;;QAGrB;QAEA,4CAA4C;QAC5C,qBACE;;8BACE,8OAAC;oBAAW,GAAG,KAAK;;;;;;gBACnB;;;IAGP;AACF"}},
    {"offset": {"line": 132, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/tanmay/mental-health-assistant/frontend/lib/api.js"],"sourcesContent":["import { getSession } from \"next-auth/react\";\r\n\r\nexport async function api(path, options = {}) {\r\n  const session = await getSession();\r\n\r\n  const res = await fetch(\r\n    `${process.env.NEXT_PUBLIC_API_URL}${path}`,\r\n    {\r\n      method: options.method || \"GET\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        ...(session?.backendToken && {\r\n          Authorization: `Bearer ${session.backendToken}`,\r\n        }),\r\n      },\r\n      body: options.body ? JSON.stringify(options.body) : undefined,\r\n    }\r\n  );\r\n\r\n  if (!res.ok) throw new Error(\"API Error\");\r\n  return res.json();\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,IAAI,IAAI,EAAE,UAAU,CAAC,CAAC;IAC1C,MAAM,UAAU,MAAM,IAAA,4JAAU;IAEhC,MAAM,MAAM,MAAM,MAChB,gEAAqC,MAAM,EAC3C;QACE,QAAQ,QAAQ,MAAM,IAAI;QAC1B,SAAS;YACP,gBAAgB;YAChB,GAAI,SAAS,gBAAgB;gBAC3B,eAAe,CAAC,OAAO,EAAE,QAAQ,YAAY,EAAE;YACjD,CAAC;QACH;QACA,MAAM,QAAQ,IAAI,GAAG,KAAK,SAAS,CAAC,QAAQ,IAAI,IAAI;IACtD;IAGF,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;IAC7B,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///D:/projects/tanmay/mental-health-assistant/frontend/app/history/page.js"],"sourcesContent":["'use client';\r\nimport React, { useEffect, useState } from \"react\";\r\nimport withAuth from \"@/lib/withAuth\";\r\nimport { api } from '@/lib/api';\r\n\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Tooltip,\r\n  Legend,\r\n} from \"chart.js\";\r\nimport { Line } from \"react-chartjs-2\";\r\n\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Tooltip,\r\n  Legend\r\n);\r\n\r\nconst stressMap = {\r\n  Low: 1,\r\n  Moderate: 2,\r\n  High: 3,\r\n};\r\n\r\nconst HistoryPage = () => {\r\n  const [data, setData] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    api(\"/history\")\r\n      .then((result) => {\r\n        setData(result || []);\r\n        setLoading(false);\r\n      })\r\n      .catch(() => setLoading(false));\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <>\r\n        <div className=\"min-h-screen flex justify-center items-center\">\r\n          <p className=\"text-gray-500\">Loading history...</p>\r\n        </div>\r\n      </>\r\n    );\r\n  }\r\n\r\n  // Graph Data\r\n  const chartData = {\r\n    labels: data.map((d) =>\r\n      new Date(d.createdAt).toLocaleDateString()\r\n    ),\r\n    datasets: [\r\n      {\r\n        label: \"Stress Level\",\r\n        data: data.map((d) => stressMap[d.stressLevel]),\r\n        fill: false,\r\n        borderWidth: 2,\r\n      },\r\n    ],\r\n  };\r\n\r\n  return (\r\n    <>\r\n\r\n      <div className=\"min-h-screen bg-gray-50 px-4 py-8\">\r\n        <div className=\"max-w-7xl mx-auto\">\r\n\r\n          {/* Title */}\r\n          <h1 className=\"text-3xl font-semibold text-gray-800\">\r\n            Mood & Stress History\r\n          </h1>\r\n          <p className=\"text-gray-600 mt-1\">\r\n            Track your mental wellness over time\r\n          </p>\r\n\r\n          {/* Graph */}\r\n          <div className=\"bg-white mt-8 p-6 rounded-xl shadow-sm\">\r\n            <h2 className=\"text-lg font-semibold text-gray-800 mb-4\">\r\n              Stress Trend\r\n            </h2>\r\n            {data.length === 0 ? (\r\n              <p className=\"text-gray-500\">No data available.</p>\r\n            ) : (\r\n              <Line data={chartData} />\r\n            )}\r\n            <p className=\"text-xs text-gray-500 mt-3\">\r\n              Low = 1, Moderate = 2, High = 3\r\n            </p>\r\n          </div>\r\n\r\n          {/* Table */}\r\n          <div className=\"bg-white mt-8 p-6 rounded-xl shadow-sm overflow-x-auto\">\r\n            <h2 className=\"text-lg font-semibold text-gray-800 mb-4\">\r\n              Check-In History\r\n            </h2>\r\n\r\n            <table className=\"w-full border-collapse text-sm\">\r\n              <thead>\r\n                <tr className=\"border-b text-left text-gray-600\">\r\n                  <th className=\"py-2\">Date</th>\r\n                  <th>Mood</th>\r\n                  <th>Stress</th>\r\n                  <th>Sleep (hrs)</th>\r\n                  <th>Study (hrs)</th>\r\n                  <th>Screen (hrs)</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {data.map((item) => (\r\n                  <tr key={item._id} className=\"border-b text-gray-700\">\r\n                    <td className=\"py-2\">\r\n                      {new Date(item.createdAt).toLocaleDateString()}\r\n                    </td>\r\n                    <td>{item.mood}</td>\r\n                    <td>{item.stressLevel}</td>\r\n                    <td>{item.sleepHours}</td>\r\n                    <td>{item.studyHours}</td>\r\n                    <td>{item.screenTime}</td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n\r\n          {/* Disclaimer */}\r\n          <p className=\"mt-8 text-xs text-gray-500 max-w-xl\">\r\n            The history shown is for self-reflection and educational purposes\r\n            only and should not be considered a medical assessment.\r\n          </p>\r\n\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default withAuth(HistoryPage);\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AAEA;AASA;AAdA;;;;;;;AAgBA,qKAAO,CAAC,QAAQ,CACd,6KAAa,EACb,2KAAW,EACX,4KAAY,EACZ,2KAAW,EACX,uKAAO,EACP,sKAAM;AAGR,MAAM,YAAY;IAChB,KAAK;IACL,UAAU;IACV,MAAM;AACR;AAEA,MAAM,cAAc;IAClB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC,EAAE;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,IAAA,iHAAG,EAAC,YACD,IAAI,CAAC,CAAC;YACL,QAAQ,UAAU,EAAE;YACpB,WAAW;QACb,GACC,KAAK,CAAC,IAAM,WAAW;IAC5B,GAAG,EAAE;IAEL,IAAI,SAAS;QACX,qBACE;sBACE,cAAA,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAE,WAAU;8BAAgB;;;;;;;;;;;;IAIrC;IAEA,aAAa;IACb,MAAM,YAAY;QAChB,QAAQ,KAAK,GAAG,CAAC,CAAC,IAChB,IAAI,KAAK,EAAE,SAAS,EAAE,kBAAkB;QAE1C,UAAU;YACR;gBACE,OAAO;gBACP,MAAM,KAAK,GAAG,CAAC,CAAC,IAAM,SAAS,CAAC,EAAE,WAAW,CAAC;gBAC9C,MAAM;gBACN,aAAa;YACf;SACD;IACH;IAEA,qBACE;kBAEE,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCAGb,8OAAC;wBAAG,WAAU;kCAAuC;;;;;;kCAGrD,8OAAC;wBAAE,WAAU;kCAAqB;;;;;;kCAKlC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAA2C;;;;;;4BAGxD,KAAK,MAAM,KAAK,kBACf,8OAAC;gCAAE,WAAU;0CAAgB;;;;;yFAE7B,8OAAC,8JAAI;gCAAC,MAAM;;;;;;0CAEd,8OAAC;gCAAE,WAAU;0CAA6B;;;;;;;;;;;;kCAM5C,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAA2C;;;;;;0CAIzD,8OAAC;gCAAM,WAAU;;kDACf,8OAAC;kDACC,cAAA,8OAAC;4CAAG,WAAU;;8DACZ,8OAAC;oDAAG,WAAU;8DAAO;;;;;;8DACrB,8OAAC;8DAAG;;;;;;8DACJ,8OAAC;8DAAG;;;;;;8DACJ,8OAAC;8DAAG;;;;;;8DACJ,8OAAC;8DAAG;;;;;;8DACJ,8OAAC;8DAAG;;;;;;;;;;;;;;;;;kDAGR,8OAAC;kDACE,KAAK,GAAG,CAAC,CAAC,qBACT,8OAAC;gDAAkB,WAAU;;kEAC3B,8OAAC;wDAAG,WAAU;kEACX,IAAI,KAAK,KAAK,SAAS,EAAE,kBAAkB;;;;;;kEAE9C,8OAAC;kEAAI,KAAK,IAAI;;;;;;kEACd,8OAAC;kEAAI,KAAK,WAAW;;;;;;kEACrB,8OAAC;kEAAI,KAAK,UAAU;;;;;;kEACpB,8OAAC;kEAAI,KAAK,UAAU;;;;;;kEACpB,8OAAC;kEAAI,KAAK,UAAU;;;;;;;+CARb,KAAK,GAAG;;;;;;;;;;;;;;;;;;;;;;kCAgBzB,8OAAC;wBAAE,WAAU;kCAAsC;;;;;;;;;;;;;;;;;;AAS7D;uCAEe,IAAA,0HAAQ,EAAC"}}]
}